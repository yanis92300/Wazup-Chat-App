{"ast":null,"code":"var _jsxFileName = \"/home/chamson/Bureau/yanis_nicolas_webtech/05.mui/lab/front-end/src/channel/List.js\",\n    _s = $RefreshSig$();\n\n/** @jsxImportSource @emotion/react */\nimport { forwardRef, useImperativeHandle, useLayoutEffect, useRef } from 'react'; // Layout\n\nimport { useTheme } from '@mui/styles'; // Markdown\n\nimport { unified } from 'unified';\nimport markdown from 'remark-parse';\nimport remark2rehype from 'remark-rehype';\nimport html from 'rehype-stringify'; // Time\n\nimport dayjs from 'dayjs';\nimport calendar from 'dayjs/plugin/calendar';\nimport updateLocale from 'dayjs/plugin/updateLocale';\nimport { jsxDEV as _jsxDEV } from \"@emotion/react/jsx-dev-runtime\";\ndayjs.extend(calendar);\ndayjs.extend(updateLocale);\ndayjs.updateLocale('en', {\n  calendar: {\n    sameElse: 'DD/MM/YYYY hh:mm A'\n  }\n});\n\nconst useStyles = theme => ({\n  root: {\n    flex: '1 1 auto',\n    overflow: 'auto',\n    '& ul': {\n      'margin': 0,\n      'padding': 0,\n      'textIndent': 0,\n      'listStyleType': 0\n    }\n  },\n  message: {\n    padding: '.2rem .5rem',\n    ':hover': {\n      backgroundColor: 'rgba(255,255,255,.2)'\n    }\n  }\n});\n\nexport default _c2 = /*#__PURE__*/forwardRef(_c = _s(({\n  channel,\n  messages,\n  onScrollDown\n}, ref) => {\n  _s();\n\n  const styles = useStyles(useTheme()); // Expose the `scroll` action\n\n  useImperativeHandle(ref, () => ({\n    scroll: scroll\n  }));\n  const rootEl = useRef(null);\n  const scrollEl = useRef(null);\n\n  const scroll = () => {\n    scrollEl.current.scrollIntoView();\n  }; // See https://dev.to/n8tb1t/tracking-scroll-position-with-react-hooks-3bbj\n\n\n  const throttleTimeout = useRef(null); // react-hooks/exhaustive-deps\n\n  useLayoutEffect(() => {\n    const rootNode = rootEl.current; // react-hooks/exhaustive-deps\n\n    const handleScroll = () => {\n      if (throttleTimeout.current === null) {\n        throttleTimeout.current = setTimeout(() => {\n          throttleTimeout.current = null;\n          const {\n            scrollTop,\n            offsetHeight,\n            scrollHeight\n          } = rootNode; // react-hooks/exhaustive-deps\n\n          onScrollDown(scrollTop + offsetHeight < scrollHeight);\n        }, 200);\n      }\n    };\n\n    handleScroll();\n    rootNode.addEventListener('scroll', handleScroll);\n    return () => rootNode.removeEventListener('scroll', handleScroll);\n  });\n  return _jsxDEV(\"div\", {\n    css: styles.root,\n    ref: rootEl,\n    children: [_jsxDEV(\"h1\", {\n      children: [\"Messages for \", channel.name]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), _jsxDEV(\"ul\", {\n      children: messages.map((message, i) => {\n        const {\n          value\n        } = unified().use(markdown).use(remark2rehype).use(html).processSync(message.content);\n        return _jsxDEV(\"li\", {\n          css: styles.message,\n          children: [_jsxDEV(\"p\", {\n            children: [_jsxDEV(\"span\", {\n              children: message.author\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 19\n            }, this), ' - ', _jsxDEV(\"span\", {\n              children: dayjs().calendar(message.creation)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 17\n          }, this), _jsxDEV(\"div\", {\n            dangerouslySetInnerHTML: {\n              __html: value\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 17\n          }, this)]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 15\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), _jsxDEV(\"div\", {\n      ref: scrollEl\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}, \"mL6R8kzlPR5VQh84bChLahRBHtI=\", false, function () {\n  return [useStyles, useTheme, useImperativeHandle];\n}));\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"%default%$forwardRef\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/home/chamson/Bureau/yanis_nicolas_webtech/05.mui/lab/front-end/src/channel/List.js"],"names":["forwardRef","useImperativeHandle","useLayoutEffect","useRef","useTheme","unified","markdown","remark2rehype","html","dayjs","calendar","updateLocale","extend","sameElse","useStyles","theme","root","flex","overflow","message","padding","backgroundColor","channel","messages","onScrollDown","ref","styles","scroll","rootEl","scrollEl","current","scrollIntoView","throttleTimeout","rootNode","handleScroll","setTimeout","scrollTop","offsetHeight","scrollHeight","addEventListener","removeEventListener","name","map","i","value","use","processSync","content","author","creation","__html"],"mappings":"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","sourcesContent":["\n/** @jsxImportSource @emotion/react */\nimport {forwardRef, useImperativeHandle, useLayoutEffect, useRef} from 'react'\n// Layout\nimport { useTheme } from '@mui/styles';\n// Markdown\nimport {unified} from 'unified'\nimport markdown from 'remark-parse'\nimport remark2rehype from 'remark-rehype'\nimport html from 'rehype-stringify'\n// Time\nimport dayjs from 'dayjs'\nimport calendar from 'dayjs/plugin/calendar'\nimport updateLocale from 'dayjs/plugin/updateLocale'\ndayjs.extend(calendar)\ndayjs.extend(updateLocale)\ndayjs.updateLocale('en', {\n  calendar: {\n    sameElse: 'DD/MM/YYYY hh:mm A'\n  }\n})\n\nconst useStyles = (theme) => ({\n  root: {\n    flex: '1 1 auto',\n    overflow: 'auto',\n    '& ul': {\n      'margin': 0,\n      'padding': 0,\n      'textIndent': 0,\n      'listStyleType': 0,\n    },\n  },\n  message: {\n    padding: '.2rem .5rem',\n    ':hover': {\n      backgroundColor: 'rgba(255,255,255,.2)',\n    },\n  },\n})\n\nexport default forwardRef(({\n  channel,\n  messages,\n  onScrollDown,\n}, ref) => {\n  const styles = useStyles(useTheme())\n  // Expose the `scroll` action\n  useImperativeHandle(ref, () => ({\n    scroll: scroll\n  }));\n  const rootEl = useRef(null)\n  const scrollEl = useRef(null)\n  const scroll = () => {\n    scrollEl.current.scrollIntoView()\n  }\n  // See https://dev.to/n8tb1t/tracking-scroll-position-with-react-hooks-3bbj\n  const throttleTimeout = useRef(null) // react-hooks/exhaustive-deps\n  useLayoutEffect( () => {\n    const rootNode = rootEl.current // react-hooks/exhaustive-deps\n    const handleScroll = () => {\n      if (throttleTimeout.current === null) {\n        throttleTimeout.current = setTimeout(() => {\n          throttleTimeout.current = null\n          const {scrollTop, offsetHeight, scrollHeight} = rootNode // react-hooks/exhaustive-deps\n          onScrollDown(scrollTop + offsetHeight < scrollHeight)\n        }, 200)\n      }\n    }\n    handleScroll()\n    rootNode.addEventListener('scroll', handleScroll)\n    return () => rootNode.removeEventListener('scroll', handleScroll)\n  })\n  return (\n    <div css={styles.root} ref={rootEl}>\n      <h1>Messages for {channel.name}</h1>\n      <ul>\n        { messages.map( (message, i) => {\n            const {value} = unified()\n            .use(markdown)\n            .use(remark2rehype)\n            .use(html)\n            .processSync(message.content);\n            return (\n              <li key={i} css={styles.message}>\n                <p>\n                  <span>{message.author}</span>\n                  {' - '}\n                  <span>{dayjs().calendar(message.creation)}</span>\n                </p>\n                <div dangerouslySetInnerHTML={{__html: value}}>\n                </div>\n              </li>\n            )\n        })}\n      </ul>\n      <div ref={scrollEl} />\n    </div>\n  )\n})\n"]},"metadata":{},"sourceType":"module"}